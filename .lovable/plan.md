

# ุชุญุณูู ุชุทุจูู ุงููุฑุขู: ุชูุณูุฑ + ุนูู ุจุฏูู ุฅูุชุฑูุช + ุชูุฒููุงุช

## ุงูููุฎุต
ุฅุนุงุฏุฉ ุชุตููู ุตูุญุฉ ุงูุณูุฑ ูุนุฑุถ ูู ุขูุฉ ูู ุจุทุงูุฉ ูููุตูุฉ ูุน ุชูุณูุฑ ูุงุจู ููุทู (ูุซู ุงูุตูุฑุฉ ุงููุฑููุฉ)ุ ูุฅุถุงูุฉ ุชูุณูุฑ ุนุฑุจู ูู API quran.comุ ูุน ุชุญุณูู ุงูุชุฎุฒูู ุงููุคูุช ููุนูู ุจุฏูู ุฅูุชุฑูุชุ ูุฅุถุงูุฉ ุตูุญุฉ ุชูุฒููุงุช ููุตูุช.

---

## 1. ุฅุถุงูุฉ ุงูุชูุณูุฑ ูุฅุนุงุฏุฉ ุชุตููู ุตูุญุฉ ุงูุณูุฑ

### ุชุนุฏูู `src/hooks/useVerses.ts`
- ุฅุถุงูุฉ ุญูู `tafsir` ุฅูู ูุงุฌูุฉ `Verse`
- ุฌูุจ ุงูุชูุณูุฑ ุงูููุณุฑ ูู quran.com API (resource_id: 816 - ุงูุชูุณูุฑ ุงูููุณุฑ)
- ุงูุฑุงุจุท: `GET /quran/tafsirs/816?chapter_number={surahId}`
- ุฏูุฌ ุงูุชูุณูุฑ ูุน ุจูุงูุงุช ุงูุขูุฉ ุงูุญุงููุฉ

### ุฅุนุงุฏุฉ ุชุตููู `src/pages/SurahPage.tsx` (ูุซู ุงูุตูุฑุฉ ุงููุฑููุฉ)
ุงูุชุตููู ุงูุฌุฏูุฏ ูุนุฑุถ ูู ุขูุฉ ูู ุจุทุงูุฉ ูููุตูุฉ:

```text
+---------------------------------------+
|  โฒ  ุจูุณููู ูฑูููููู ูฑูุฑููุญููููฐูู โ   ๐ |
|---------------------------------------|
| (ุงูุชูุณูุฑ ุงูููุณุฑ) ุณูุฑุฉ ุงููุงุชุญุฉ ุณููุช    |
| ูุฐู ุงูุณูุฑุฉ ุจุงููุงุชุญุฉ ูุฃูู ููุชุชุญ ุจูุง   |
| ุงููุฑุขู ุงูุนุธูู...                       |
+---------------------------------------+

+---------------------------------------+
|  โผ  ูฑููุญูููุฏู ููููููู ุฑูุจูู โก        ๐ |
+---------------------------------------+

+---------------------------------------+
|  โผ  ูฑูุฑููุญููููฐูู ูฑูุฑููุญูููู โข        ๐ |
+---------------------------------------+
```

ูู ุจุทุงูุฉ ุชุญุชูู:
- ุงููุต ุงููุฑุขูู ุจุฎุท ุนุซูุงูู ูุจูุฑ (ูุญุงุฐุงุฉ ูููู)
- ุฑูู ุงูุขูุฉ
- ุฃููููุฉ ุฅุดุงุฑุฉ ูุฑุฌุนูุฉ (Bookmark)
- ุณูู ููุทู/ุงููุชุญ (โฒ ููุชูุญ / โผ ูุบูู)
- ุนูุฏ ุงููุชุญ: ูุธูุฑ ูุต ุงูุชูุณูุฑ ุงูููุณุฑ ุชุญุช ุงูุขูุฉ
- ุชุธููู ุชููุงุฆู ููุขูุฉ ุฃุซูุงุก ุงูุชูุงูุฉ (ุงููุธุงู ุงูุญุงูู ูุนูู ุจุงููุนู ูุน timestamps)
- ุนูุฏ ุงูุถุบุท ุนูู ุฃููููุฉ ุงูุชุดุบูู: ุชุจุฏุฃ ุงูุชูุงูุฉ ูู ูุฐู ุงูุขูุฉ

### ุชุตููู ุงูุจุทุงูุฉ:
- ุญุฏูุฏ ุฎุถุฑุงุก/ุฐูุจูุฉ ููุจุทุงูุฉ ุงููุดุทุฉ (ุฃุซูุงุก ุงูุชูุงูุฉ)
- ุฎูููุฉ ูููุฒุฉ ููุจุทุงูุฉ ุงูููุชูุญุฉ
- ุญุฑูุฉ ุงูุชูุงู ุณูุณุฉ ุนูุฏ ุงููุชุญ/ุงูุฅุบูุงู

---

## 2. ุงูุนูู ุจุฏูู ุฅูุชุฑูุช (ุชุฎุฒูู ูุญุณูู)

### ุชุนุฏูู `src/hooks/useVerses.ts`
- ุงุณุชุฎุฏุงู `staleTime: Infinity` ู`gcTime: Infinity` ูู React Query
- ุฅุถุงูุฉ ูุธุงู ุชุฎุฒูู ูู `localStorage` ูู fallback:
  - ุจุนุฏ ุฌูุจ ุงูุขูุงุช ูุงูุชูุณูุฑ ูุฃูู ูุฑุฉ: ุญูุธูุง ูู `localStorage` ุจููุชุงุญ `quran-surah-{id}`
  - ุนูุฏ ููุฏุงู ุงูุงุชุตุงู: ูุฑุงุกุฉ ุงูุจูุงูุงุช ูู `localStorage`
  - ุงูุญุฏ ุงูุฃูุตู ููุชุฎุฒูู: ~5MB (ูููู ููู ุงููุฑุขู ูุน ุงูุชูุณูุฑ)

### ุชุนุฏูู `src/hooks/useQuranAudio.ts`
- ููุณ ุงููููุฌ: ุชุฎุฒูู ุจูุงูุงุช ุงูุตูุช (URLs + timestamps) ูู localStorage

---

## 3. ุชุธููู ุงูุขูุงุช ุฃุซูุงุก ุงูุชูุงูุฉ

ุงููุธุงู ุงูุญุงูู ูุนูู ุจุงููุนู ุจุงุณุชุฎุฏุงู timestamps ูู quran.com API:
- `useQuranAudio` ูุชุชุจุน `currentVerseKey` ุนุจุฑ ููุงุฑูุฉ ููุช ุงูุชุดุบูู ูุน timestamps
- `SurahPage` ูุถูู class `bg-accent/20` ููุขูุฉ ุงููุดุทุฉ
- ุงูุชูุฑูุฑ ุงูุชููุงุฆู ูุนูู ุนุจุฑ `scrollIntoView`

### ุงูุชุญุณููุงุช:
- ุฅุถุงูุฉ ุชุฃุซูุฑ ุจุตุฑู ุฃููู ููุขูุฉ ุงููุดุทุฉ (ุญุฏูุฏ ุฐูุจูุฉ ูุชุญุฑูุฉ)
- ูุชุญ ุงูุชูุณูุฑ ุชููุงุฆูุงู ููุขูุฉ ุงููุดุทุฉ (ุงุฎุชูุงุฑู)
- ุชุญุณูู ุงูุชูุฑูุฑ ููููู ุฃูุซุฑ ุณูุงุณุฉ

> ููุงุญุธุฉ: ุชุธููู ุงูุขูุงุช ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู (ุงูุชุนุฑู ุนูู ุงูุตูุช ูู ุงูููุช ุงููุนูู) ุบูุฑ ูููู ุชูููุงู ูู ุชุทุจูู ููุจ ุจุณูุท. ุงููุธุงู ุงูุญุงูู ูุณุชุฎุฏู timestamps ูุญุฏุฏุฉ ูุณุจูุงู ูู API ููู ุงูุฃุณููุจ ุงููุนุชูุฏ ูู ุฌููุน ุชุทุจููุงุช ุงููุฑุขู.

---

## 4. ุตูุญุฉ ุงูุชูุฒููุงุช

### ููู ุฌุฏูุฏ: `src/pages/DownloadsPage.tsx`
- ุนุฑุถ ูุงุฆูุฉ ุงูุณูุฑ ูุน ุฒุฑ ุชุญููู ููู ุณูุฑุฉ
- ุงุฎุชูุงุฑ ุงููุงุฑุฆ ุงููุทููุจ
- ุนูุฏ ุงูุถุบุท ุนูู "ุชุญููู":
  - ุงุณุชุฎุฏุงู `<a href={audioUrl} download>` ูุชุญููู ุงูููู ูุจุงุดุฑุฉ
  - ุนุฑุถ ุญุงูุฉ ุงูุชุญููู (ุฌุงุฑู ุงูุชุญููู / ููุชูู)
- ุนุฑุถ ุงูุณูุฑ ุงููุญููุฉ ูุณุจูุงู ูุน ุฅููุงููุฉ ุงูุชุดุบูู ุงููุจุงุดุฑ

### ุชุนุฏูู `src/App.tsx`
- ุฅุถุงูุฉ Route: `/downloads` -> `DownloadsPage`

### ุชุนุฏูู `src/components/layout/BottomNav.tsx` ุฃู `src/pages/MorePage.tsx`
- ุฅุถุงูุฉ ุฑุงุจุท "ุงูุชูุฒููุงุช" ูู ุตูุญุฉ ุงููุฒูุฏ

### ุชุนุฏูู `src/i18n/translations.ts`
- ุฅุถุงูุฉ ุชุฑุฌูุงุช ุงูุชูุฒููุงุช: `downloads: { title, download, downloaded, downloading, playOffline }`

---

## ููุฎุต ุงููููุงุช ุงููุชุฃุซุฑุฉ

| ุงูููู | ููุน ุงูุชุบููุฑ |
|-------|-------------|
| `src/hooks/useVerses.ts` | ุชุนุฏูู: ุฅุถุงูุฉ ุฌูุจ ุงูุชูุณูุฑ + ุชุฎุฒูู ูุญูู |
| `src/pages/SurahPage.tsx` | ุฅุนุงุฏุฉ ุชุตููู: ุจุทุงูุงุช ุขูุงุช ูุงุจูุฉ ููุทู ูุน ุชูุณูุฑ |
| `src/pages/DownloadsPage.tsx` | ููู ุฌุฏูุฏ: ุตูุญุฉ ุงูุชูุฒููุงุช |
| `src/App.tsx` | ุชุนุฏูู: ุฅุถุงูุฉ route ุงูุชูุฒููุงุช |
| `src/pages/MorePage.tsx` | ุชุนุฏูู: ุฅุถุงูุฉ ุฑุงุจุท ุงูุชูุฒููุงุช |
| `src/i18n/translations.ts` | ุชุนุฏูู: ุฅุถุงูุฉ ุชุฑุฌูุงุช ุงูุชูุฒููุงุช |

